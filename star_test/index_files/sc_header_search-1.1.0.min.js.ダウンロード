/*
 sc_header_search.js 1.1.0
 Copyright (c) 2017 Rakuten.Inc
 Date : 2017-07-11 10:26:48
*/
Rmodules.define(["jQuery","R^1"],function(b,i){var f="function"===typeof s_setL2id,d=function(c){this.$config=c;this.cssDisplayPopup="display-search-popup";this.$body=b("body");this.$searchTopDiv=b("#rstTopSearch");this.$searchBoxPopup=b("#searchBoxPopup");this.$searchButton=b("#searchPopupSubmit");this.$searchBarPlaceHolder=b("#searchBarPlaceHolder");this.$searchModalOverlay=b("#searchBoxModalOverlay");this.$searchSelectedOption=this.$searchBoxPopup.find('input[type="radio"][name="sid"]');this.$searchTextInput=
b("#searchPopupItemNum");this.$searchL2IDInput=b("#searchPopupL2ID");this.$searchArea=b("#searchArea");this.$searchPopupCloseButton=b("#searchPopupCloseButton");this.propId=this.$config.attr("data-sc-id")||this.defaults.sitecatalyst.propId;this.scValAllShopL2ID=this.$config.attr("data-sc-value-allshop-l2id")||this.defaults.sitecatalyst.scValAllShopL2ID;this.scValInShopL2ID=this.$config.attr("data-sc-value-inshop-l2id")||this.defaults.sitecatalyst.scValInShopL2ID;this.scValAllShopRadio=this.$config.attr("data-sc-value-allshop-radio-click")||
this.defaults.sitecatalyst.scValAllShopRadio;this.scValInShopRadio=this.$config.attr("data-sc-value-inshop-radio-click")||this.defaults.sitecatalyst.scValInShopRadio;this.optionIchiba=this.defaults.radioId.optionIchiba;this.optionInshop=this.defaults.radioId.optionInshop;this.defaultMessage=this.defaults.messages.defaultMessage;this.allShopMessage=this.defaults.messages.allShopMessage;this.inShopMessage=this.defaults.messages.inShopMessage};d.prototype={defaults:{sitecatalyst:{propId:"prop18",scValAllShopL2ID:"item_SP_SearchHeaderAll",
scValInShopL2ID:"item_SP_SearchHeaderIn",scValAllShopRadio:"item_SP_SearchOptionAll",scValInShopRadio:"item_SP_SearchOptionIn"},radioId:{optionIchiba:"searchBoxOptionIchiba",optionInshop:"searchBoxOptionInShop"},messages:{defaultMessage:"全商品 / ショップ内から探す",allShopMessage:"全商品から探す",inShopMessage:"ショップ内から探す"}},initialize:function(){function c(b){return function(){var c={};c[a.propId]=e("radioId");a.$searchTextInput.attr("placeholder",b);i.sendToSc(c)}}function e(b){var c=a.$searchSelectedOption.filter(":checked").attr("id"),
d="",e="";a.optionIchiba===c?(d=a.scValAllShopL2ID,e=a.scValAllShopRadio):(d=a.scValInShopL2ID,e=a.scValInShopRadio);return"l2Id"===b?d:e}function g(a){a.preventDefault()}function d(){a.$searchBoxPopup.hasClass(a.cssDisplayPopup)||(a.$searchTextInput.attr("placeholder",a.defaultMessage),a.$searchTextInput.val(""),a.$searchSelectedOption.filter("#searchBoxOptionIchiba").prop("checked",!0),a.$searchBoxPopup.addClass(a.cssDisplayPopup),a.$searchTextInput.focus(),a.$body.css("overflow","hidden"),a.$searchTopDiv.addClass("inShopPopUpEnable"),
a.$body.click(function(){b(this).on("touchmove",g)}))}function h(){a.$searchBoxPopup.hasClass(a.cssDisplayPopup)&&(a.$searchBoxPopup.removeClass(a.cssDisplayPopup),a.$body.css("overflow",""),a.$searchTopDiv.removeClass("inShopPopUpEnable"),a.$body.click(function(){b(this).off("touchmove",g)}))}var a=this;a.$searchArea.hasClass("inshop")&&(a.$searchBarPlaceHolder.on("click",d),a.$searchArea.find("input").attr("readonly","readonly"));a.$searchModalOverlay.on("click",h);a.$searchPopupCloseButton.on("click",
h);a.$searchButton.on("click",function(){var b=e("l2Id");f&&s_setL2id(b);a.$searchL2IDInput.val(b)});a.$searchSelectedOption.filter("#searchBoxOptionIchiba").on("click",c(a.allShopMessage));a.$searchSelectedOption.filter("#searchBoxOptionInShop").on("click",c(a.inShopMessage))}};b(function(){var c=b("#rstTopSearch"),e=c.find("select[name=sid]");c.find('input[type="submit"]').on("click",function(){var b=e.find("option:selected").attr("data-l2-id");f&&s_setL2id(b)});c=b("#searchPopUpConfig");0<c.length&&
(new d(c)).initialize()})});
