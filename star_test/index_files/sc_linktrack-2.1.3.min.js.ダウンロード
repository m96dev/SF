(function(f,k,n){var e,d={},l,o,p,j,m=!1,i=f.s;if(!(void 0===f.jQuery||void 0===i)){e=f.jQuery.noConflict();try{d.addEvent=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)},d.delegateStl=function(a,b){var c="",c=a.match(/[\w\=]*-?id\=([\w\W\/\-\&\'\"\=\#]*)[\&\#]?/i),d=b.propOverride;if(!m&&!b.$this.attr("data-called")&&(b.$this.attr("data-called","true"),c))c=c[c.length-1],i=f.s_gi(f.s_account),i.trackExternalLinks=!1,i.linkTrackVars=d,i[d]=c,i.tl(this,"o","sc_linktrack2.0")},
d.arrayNodeIndex=function(a,b){for(var c=b.length,d=0;d<c;d+=1)if(a===b[d])return d+1;return!1},d.partsName=function(a,b){return a.id?"-"+a.id:d.arrayNodeIndex(a,b)},d.createId=function(a,b,c){var f="",q="",h=c.base,g="",g="",g={},f=-1<b.indexOf("?")?"&":"?",q=c.idType||"l-id=",b=e(a).closest(c.parentEl)[0];c.idDivNum?(g=d.partsName(b,c.list),h+="_"+c.idName+g):h+="_"+c.idName;c.idLinkNum&&(g=e(c.targetEl,b),g=d.partsName(a,g),h+="_"+g);return f+q+h},d.isIchibaDomain=function(a){var b=f.accountSetting._internalSite.length,
c=0;if(!a)return!1;if("search.rakuten.co.jp"===a)return!0;for(;c<b;c+=1)if(-1<a.indexOf(f.accountSetting._internalSite[c]))return!0;return!1},d.linkClick=function(a){var b,c=!1,c=this.getAttribute("sc-override"),a=a.data;a.thisLink=this;if(this.href){b=this.href;a.cleanHref=b.replace(/[ls]-id\=\w*&?/gi,"");if(a.cleanHref.match(/\?$/i))a.cleanHref=a.cleanHref.replace(/\?/i,"");b=this.hostname}else a.tempStlFlag=!0,a.cleanHref="";c?d.attachId(a,c):(c=/grp\d{2}\W{1}ias/i.test(b),a.idTypeOverride?a.idType=
a.idTypeOverride:a.forceParam||d.isIchibaDomain(b)&&!c?a.idType=/item|basket|cart/i.test(b)?"s-id=":"l-id=":c?a.idType="ap=s-id=":a.tempStlFlag=!0,(b=d.createId(this,a.cleanHref,a))&&d.attachId(a,b),a.tempStlFlag=!1)},d.attachId=function(a,b){a.forceStl||a.tempStlFlag?(a.$this=e(a.thisLink),d.delegateStl(b,a)):a.thisLink.href=a.cleanHref+b},d.checkDrag=function(){var a=e("body");a.bind("touchmove",function(){m=!0});a.bind("touchstart",function(){m=!1})},l=function(a){this.parentEl=a.parentel||"";
this.targetEl=a.targetel||"a";this.bindTrigger=a.bindtrigger||"click";this.path=a.path||0;this.idName=a.idname||"";this.idDivNum=a.iddivnum||!1;this.idLinkNum=a.idlinknum||!1;this.forceParam=a.forceparam||!1;this.forceStl=a.forcestl||!1;this.idTypeOverride=a.idtypeoverride||!1;this.propOverride=a.propoverride||"prop18";this.list=e(this.parentEl);this.list[0]&&this.init(this)},l.prototype={init:function(){this.getBase();this.addToInput();this.attachLinkClick()},getBase:function(){var a,b,c;o===this.path?
this.base=p:(a=n.host.replace(".rakuten.co.jp",""),b=this.getLayout(),c=this.getPath(this.path),this.base=a+"_"+b+"_"+c,o=this.path,p=this.base)},getPath:function(a){var a=parseInt(a,10),b=n.pathname,c=[],d="",e=0;if(isNaN(a)||"/"===b)return"/";if(0<a){for(c=b.match(/\W{1}\w*/g);e<a;e+=1)c[e]&&(d+=c[e]);b=d}b=b.replace(/\/index\.html?/i,"");return b.slice(1)},getLayout:function(){var a;if(void 0!==f.sc_layout)a=f.sc_layout;if(!a)try{a=k.getElementsByName("ge_layout")[0].value}catch(b){a=""}a||(a=
k.getElementsByName("viewport").length?"SP":"PC");return a},addToInput:function(){for(var a=j.length,b=0,c;b<a;b++)if(c=e(j[b]),c.attr("parentel")===this.parentEl){c.attr("result",this.base+"_"+this.idName);break}},attachLinkClick:function(){var a=this.list.length,b=0;if(e.prototype.on)for(;b<a;b++)e(this.list[b]).on(this.bindTrigger,this.targetEl,this,d.linkClick);else if(e.prototype.delegate)for(;b<a;b++)e(this.list[b]).delegate(this.targetEl,this.bindTrigger,this,d.linkClick);else for(;b<a;b++)e(this.targetEl,
this.list[b]).bind(this.bindTrigger,this,d.linkClick)}},d.init=function(){var a={},b={},c,f,i,h=0,g=0;j=e("input.sclinktrack");for(f=j.length;h<f;h++){b={};a=j[h].attributes;i=a.length;for(g=0;g<i;g++)c=a[g],b[c.nodeName.toLowerCase()]=c.value;new l(b)}d.checkDrag()},e(k).ready(function(){d.init()})}catch(r){}}})(window,document,location);
