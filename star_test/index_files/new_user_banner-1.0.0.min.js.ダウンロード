/*
 new_user_banner-1.0.0.js
 Copyright (c) 2017 Rakuten.Inc
 Date: 2017-12-04 14:25:19
*/
!function(a){"use strict";var b=a("#newUserBannerConfig");if(!+b.attr("data-disabled")){var c="1",d="2";if(!b.attr("data-target-1")){var e=b.attr("data-target");if(!e)return;b.attr("data-target-1",e),b.attr("data-values-1",b.attr("data-values"))}var f=function(a){a=a.split(/; */);for(var b=0;a.length>b;b++)if(/^Rz=/.test(a[b]))return!0;return!1}(document.cookie),g=function(c){/^[0-9]+$/.test(c)&&(c=b.attr("data-target-"+c)),c&&(+b.attr("data-wait-dom")?a(function(){a(c).show()}):a(c).show())},h=function(a){
for(var c,d,e=1;c=b.attr("data-target-"+e);e++){if(d=b.attr("data-values-"+e),d=d||1==e?(d||"0").split(","):[],0==d.length)return g(c);for(var f=0;d.length>f;f++)if(d[f]==a)return g(c)}},i={SESSION_STORAGE_KEY:"newUserBannerCache",get:function(){return sessionStorage&&sessionStorage.getItem(this.SESSION_STORAGE_KEY)},set:function(a){try{sessionStorage.setItem(this.SESSION_STORAGE_KEY,a)}catch(b){}}};if(!f)return g(b.attr("data-nologin-target")||c);var j=navigator.userAgent;if(/MSIE [6789]/.test(j))return g(b.attr("data-oldie-target")||d);
var k=i.get();if(null!=k)return h(k);var l="https://ucache.api.rakuten.co.jp/capi/v1/coupon/user.json",m=/iPhone|iPod|Android.+Mobile/.test(j)?9e3:3e3,n="0",o=b.attr("data-url")||l,p=b.attr("data-timeout")||m,q=+b.attr("data-rat-aid"),r=+b.attr("data-rat-acc");a.ajax({url:o,type:"get",dataType:"json",data:{aid:q,acc:r},timeout:p,xhrFields:{withCredentials:!0},beforeSend:function(a){a.withCredentials=!0},success:function(a){for(var c=a?a.items?a.items.ichiba_order_recency:0:null,d=(b.attr("data-nocache")||n).split(","),e=0;d.length>e;e++)if(d[e]==c||"*"==d[e])return h(c);
i.set(c),h(c)},error:function(){return g(b.attr("data-apierror-target")||d)}})}}(window.jQuery);
